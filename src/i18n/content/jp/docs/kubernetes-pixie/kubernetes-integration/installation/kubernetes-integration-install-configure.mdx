---
title: 'Kubernetesインテグレーション: インストールおよび設定'
tags:
  - Integrations
  - Kubernetes integration
  - Installation
metaDescription: 'New Relic''s Kubernetes integration: How to install and activate the integration, and what data is reported.'
---

import pivotal from './images/pivotal.png'

import aks from './images/aks.png'

import openshift from './images/openshift.png'

import cke from './images/cke.jpeg'

import eks from './images/eks.png'

Kubernetesインテグレーションをインストールする最も近道は、自動化されたインストーラを使用してマニフェストを生成することです。生成されたマニフェストは、インテグレーションDaemonSetsのみならず、[Kubernetesイベント](/docs/integrations/kubernetes-integration/kubernetes-events/install-kubernetes-events-integration)、[Prometheus OpenMetrics](/docs/integrations/prometheus-integrations/get-started/new-relic-prometheus-openmetrics-integration-kubernetes)、[New Relicログモニタリング](/docs/logs)など、その他のNew Relic Kubernetes製品の設定もバンドルします。

きめ細かなテレメトリデータ用に、PixieとNew Relic Oneインテグレーションをインストールしたいとお考えですか？1つのインストールコマンドで、Kubernetesクラスタとワークロードをより深く理解するには、[Pixieを使用した自動テレメトリのインストール手順](/docs/auto-telemetry-pixie/get-started-auto-telemetry-pixie/#install-auto-telemetry-with-pixie)をご覧ください。言語エージェントは必要ありません。

当社のKubernetesインテグレーションをお試しになりますか？[New Relicアカウントの作成](https://newrelic.com/signup)は無料です。クレジットカードは不要です。

## 自動インストーラの使用 [#installer]

サーバー、VM、特権のない環境で、自動化されたインストーラを使用することをお勧めします。自動化されたインストーラは、必要な値が入力されたHelmコマンド、またはHelmを使用しない場合はプレーンなマニフェストを提供できます。また、優れたカスタマイズ性と、どの機能と依存関係を有効にするかを完全に制御できます。マネージドクラウドにインテグレーションをインストールする場合は、先に進む前に、これらの[予備ノート](#cloud-platforms)を参照してください。

または、[Helmを使用してインテグレーションをデプロイする](/docs/integrations/kubernetes-integration/installation/install-kubernetes-integration-using-helm)ための完全なマニュアル手順も提供しています。

<ButtonLink
  role="button"
  to="https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0="
  variant="primary"
>
  インストーラの起動
</ButtonLink>

New Relicアカウント[がEU地域](/docs/using-new-relic/welcome-new-relic/get-started/our-eu-us-region-data-centers)にある場合は、[one.eu.newrelic.com](http://one.eu.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0=)からインストーラにアクセスします。

## マネージドサービスとプラットフォーム向けのインストール [#cloud-platforms]

[自動化されたインストーラ](https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0=)を起動する前に、次のマネージドサービスまたはプラットフォーム向けのメモを確認してください。

<CollapserGroup>
  <Collapser
    className="freq-link"
    id="install-amazon-eks"
    title={<><img src={eks} alt="EKS" style={{ verticalAlign: 'middle' }}/><Link to="#install-amazon-eks">Amazon EKS</Link></>}
  >
    Kubernetesインテグレーションは、ワーカーノードを監視します。Amazon EKSでは、マスターノードはAmazonによって管理され、Kubernetesプラットフォームから抽出されます。

    [自動化されたインストーラ](https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0=)を起動し、KubernetesインテグレーションをAmazon EKSにディプロイする前に、AWSが提供した[`kubectl`のバージョンを使用していることを確認します](https://docs.aws.amazon.com/eks/latest/userguide/configure-kubectl.html)。
  </Collapser>

  <Collapser
    className="freq-link"
    id="install-amazon-eks-fargate"
    title={<><img src={eks} alt="EKS" style={{ verticalAlign: 'middle' }}/><Link to="#install-amazon-eks-fargate">Amazon EKS Fargate</Link></>}
  >
    EKS Fargateクラスタへのインストールには、専用の手順が必要です。詳細は、[Fargateインストールドキュメント](/docs/integrations/kubernetes-integration/installation/install-fargate-integration)を参照してください。
  </Collapser>

  <Collapser
    className="freq-link"
    id="install-google-kubernetes-engine"
    title={<><img src={cke} alt="CKE" style={{ verticalAlign: 'middle' }}/><Link to="#install-google-kubernetes-engine">Google Kubernetes Engine （GKE）</Link></>}
  >
    Kubernetesインテグレーションは、ワーカーノードを監視します。GKEでは、マスターノードはGoogleによって管理され、Kubernetesプラットフォームから抽出されます。

    [自動化されたインストーラ](https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0=)を起動し、GKEにKubernetesインテグレーションをディプロイする前に、十分な権限があることを確認してください。

    1. [console.cloud.google.com/iam-admin/iam](https://console.cloud.google.com/iam-admin/iam)に移動し、ユーザー名を見つけます。**編集**をクリックします。
    2. `ロール`および`ClusterRoles`を作成する権限があることを確認します。不確かな場合は、**Kubernetes Engine Cluster Admin**ロールを追加します。ユーザーロールを編集できない場合は、必要なパーミッションを付与してもらうようGCPプロジェクトのオーナーに依頼してください。
  </Collapser>

  <Collapser
    className="freq-link"
    id="install-openshift-container-platform"
    title={<><img src={openshift} alt="OpenShift" style={{ verticalAlign: 'middle' }}/>OpenShiftコンテナプラットフォーム</>}
  >
    [OpenShift](https://learn.openshift.com/?extIdCarryOver=true&sc_cid=701f2000001OH7iAAG)でKubernetesインテグレーションをディプロイするには、

    1. `<>{'<release_name>'}</>-newrelic-infrastructure`サービスアカウントを特権[セキュリティコンテキスト制限](https://docs.openshift.com/enterprise/3.0/admin_guide/manage_scc.html)に追加します。

       ```
       oc adm policy add-scc-to-user privileged \
       system:serviceaccount:<var><namespace></var>:<var><release_name></var>-newrelic-infrastructure
       ```

       インストーラによって提供されるデフォルトの`<>{'<release_name>'}</>`は`nri-bundle`です。

    2. [自動化されたインストーラ](https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0=)の手順を完了します。

    3. 署名入りの証明書を使用している場合は、マニフェスト内の`DaemonSet`部分で以下の変数を使用して`.pem`ファイルを設定することで、証明書が適切に設定されていることを確認します。ファイル：

       ```

       ```

    * name：NRIA_CA_BUNDLE_DIR value: <var>YOUR_CA_BUNDLE_DIR</var>

    * name：NRIA_CA_BUNDLE_FILE value: <var>YOUR_CA_BUNDLE_NAME</var>

      ```

      YAML key path: `spec.template.spec.containers.name.env`
      ```

    4. 変更内容を保存します。
  </Collapser>

  <Collapser
    className="freq-link"
    id="install-azure-aks"
    title={<><img src={aks} alt="AKS" style={{ verticalAlign: 'middle' }}/>Azure Kubernetes Service (AKS)</>}
  >
    Kubernetesインテグレーションは、ワーカーノードを監視します。Azure Kubernetes Serviceでは、マスターノードはAzureによって管理され、Kubernetesプラットフォームから抽出されます。

    Azure Kubernetes Service（AKS）にディプロイするには、[自動化されたインストーラ](https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0=)の手順を完了します。
  </Collapser>

  <Collapser
    className="freq-link"
    id="install-pks"
    title={<><img src={pivotal} alt="PKS" style={{ verticalAlign: 'middle' }}/>Pivotal Container Service (PKS / VMware Tanzu)</>}
  >
    PKSにディプロイする場合、[自動化されたインストーラ](https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0=)を使用することを推奨します。使用しない場合、[Helmを使用してKubernetesインテグレーションをインストール](/docs/integrations/kubernetes-integration/installation/install-kubernetes-integration-using-helm)に記載の手動についての説明に従います。
  </Collapser>
</CollapserGroup>

## Kubernetesインテグレーションのアップグレード

当社のKubernetesインテグレーションは、現在開発中ですが、バグ修正、新機能、および新しいKubernetesバージョンとクラウドプロバイダーのサポートを含むアップデートを定期的にリリースしています。最高のエクスペリエンスを得るために、Kubernetesインテグレーションを定期的に更新することをすべてのお客様に強くお勧めします。

### 自動化されたインストーラとHelmを使用したアップグレード

[自動化されたインストーラ](https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJndWlkZWQiLCJlbnYiOiJrdWJlcm5ldGVzIiwiaW5pdGlhbEFjdGlvbkluZGV4IjpudWxsLCJhY3Rpb25JbmRleCI6MX0=)によって提供されるHelmコマンドを使用してデプロイされたインストールを更新するには、プロセスを実行して、Helmコマンドをもう一度実行します。これにより、チャートの新しいバージョンとその依存関係が取得され、最新バージョンにアップグレードされます。

### 自動化されたインストーラとプレーンマニフェストを使用したアップグレード

<Callout variant="tip">
  また、Helmを使用してインテグレーションをデプロイすることをお勧めします。これは、マニフェストを直接使用するよりもクリーンなアップグレードパスを提供します。
</Callout>

カスタムマニフェストがHelmの代わりに使用されている場合、まず`kubectl delete -f <mark>previous-manifest-file.yml</mark>`を使用して古いインストールを削除してから、ガイド付きインストーラを再度実行することをお勧めします。これにより、`kubectl apply -f manif<mark>est-file.yml</mark>`を使用してデプロイできる一連のマニフェストが更新されます。

まず前のマニフェストファイルを削除しないで新しいバージョンのマニフェストファイルの適用はお勧めしません。クラスタにコンポーネントが残る可能性があるためです。

## Kubernetesで実行しているサービスを監視する [#services]

<Callout variant="tip">
  `Values.yml`ファイルにスニペットを追加するだけで、サービスの監視方法を簡単に設定できるため、Helmを使用してインテグレーションをデプロイすることをお勧めします。
</Callout>

Kubernetesインテグレーションをインストールした後、クラスタで実行するサービスのインストゥルメントを開始できます。この方法についての詳細は、[Kubernetesのページで実行中のサービスの監視](/docs/integrations/kubernetes-integration/link-apps-services/monitor-services-running-kubernetes/)を参照してください。

## Kubernetesデータの使用

Kubernetesデータの使用方法の詳細については、[Kubernetesデータページの詳細検索](/docs/integrations/kubernetes-integration/understand-use-data/)を参照してください。